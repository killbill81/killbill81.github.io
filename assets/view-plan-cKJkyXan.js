import{b as w,d as D,h as S}from"./firebase-config-DV_efyn3.js";import{n as P}from"./main-CbZLFheF.js";function $(){const n=localStorage.getItem("selectedPlanId"),e=document.getElementById("plan-view-name"),a=document.getElementById("meal-plan-grid"),s=document.getElementById("close-view-plan-btn");if(s&&s.addEventListener("click",()=>{localStorage.removeItem("selectedPlanId"),P("plans")}),!n)return e&&(e.textContent="Aucune sauvegarde sélectionnée"),a&&(a.innerHTML=`<p class="text-center text-red-500">Erreur : Aucun ID de sauvegarde trouvé. Veuillez retourner à la page 'Mes Plans Sauvegardés' et en sélectionner une.</p>`),()=>{};async function r(){try{const t=w(D,"plan_saves",n),o=await S(t);if(!o.exists())throw new Error("Sauvegarde non trouvée");const l=o.data(),i=l.planData;if(!i)throw new Error("Les données du plan sauvegardé sont corrompues ou manquantes.");e&&(e.textContent=`Vue de : ${l.name}`),L(a,i)}catch(t){console.error("Error fetching save:",t),e&&(e.textContent="Erreur"),a&&(a.innerHTML=`<p class="text-center text-red-500">${t.message}</p>`)}}return r(),()=>{localStorage.removeItem("selectedPlanId")}}function L(n,e){if(!n)return;n.innerHTML="";const a=Object.keys(e.weeks||{}).sort((s,r)=>parseInt(s)-parseInt(r));if(a.length===0){n.innerHTML='<p class="text-center text-gray-500 p-10 col-span-full">Ce plan est vide.</p>';return}a.forEach(s=>{const r=e.weeks[s],t=document.createElement("h3");t.className="text-lg font-bold text-gray-700 mt-6 mb-2 col-span-full",t.textContent=`Semaine ${s}`,n.appendChild(t);const o=document.createElement("div");k(o,r,e.startDay,e.defaultNumPeople),n.appendChild(o)})}function k(n,e,a,s){const r=["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],t=r.indexOf(a||"Lundi"),o=[...r.slice(t),...r.slice(0,t)],l=e.menuData||{},i=e.servingsData||{},E=e.remarksData||{};o.forEach(x=>{const v=r.indexOf(x),d=document.createElement("div");d.className="grid grid-cols-[100px_35px_repeat(5,_minmax(0,_1fr))_35px_repeat(5,_minmax(0,_1fr))] items-stretch border-b border-gray-300";const u=document.createElement("div");u.className="font-bold p-2 flex items-center justify-center bg-gray-100 text-sm border-r border-gray-300",u.textContent=x.toUpperCase(),d.appendChild(u),["lunch","dinner"].forEach(h=>{const b=`${v}-${h}`,C=i[b]||s||1,p=document.createElement("div");p.className="border-r border-gray-300 flex items-center justify-center",p.innerHTML=`<div class="text-center"><i class="fas fa-users fa-xs mb-1"></i><br>${C}</div>`,d.appendChild(p);for(let m=0;m<5;m++){const y=`${v}-${h}-${m}`,c=document.createElement("div");if(c.className="meal-slot p-1 min-h-[50px] border-r border-gray-300",m===4)c.textContent=E[y]||"",c.classList.add("text-xs","italic","text-gray-600");else{const f=l[y];Array.isArray(f)&&f.length>0&&f.forEach(I=>{const g=document.createElement("div");g.className="p-1 bg-white rounded shadow-sm text-center text-xs font-medium",g.textContent=I.name,c.appendChild(g)})}d.appendChild(c)}}),n.appendChild(d)})}export{$ as default};
