const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ingredient-modal-Bs8bmd4e.js","assets/firebase-config-9gANoKOS.js","assets/firebase-config-DuwEdJQT.css","assets/main-CPC2Lv91.js"])))=>i.map(i=>d[i]);
import{d as U,h as z,i as G,g as j,c as P,s as V,b as $,a as J,u as Q,o as K,f as W}from"./firebase-config-9gANoKOS.js";import{_ as q,e as X,s as M}from"./main-CPC2Lv91.js";class Y{constructor(){this.db=U,this.functions=z(),this.masterIngredientList=[],this.activityUpdater=null,this.onSaveCallback=null,this.listenersAttached=!1,this.currentIngredientsArray=[],this.currentRecipeOwnerId=null,this.elementIds={modal:"edit-recipe-form-modal",form:"edit-recipe-form",title:"edit-recipe-modal-title",idInput:"edit-recipe-id",nameInput:"edit-recipe-name",categoryInput:"edit-recipe-category",servingsInput:"edit-recipe-servings",prepTimeInput:"edit-recipe-prep-time",difficultyInput:"edit-recipe-difficulty",stepsTextarea:"edit-recipe-steps",ingredientsList:"edit-ingredients-list",addIngredientBtn:"edit-add-ingredient-btn",saveBtn:"edit-save-recipe-btn",closeBtn:"close-edit-recipe-modal",cancelBtn:"edit-cancel-recipe-btn",imageUrlInput:"edit-recipe-image-url",magicImportUrl:"magic-import-url",magicImportBtn:"btn-magic-import",magicImportStatus:"magic-import-status",aiGeneratePrompt:"ai-generate-prompt",aiGenerateBtn:"btn-ai-generate",aiGenerateStatus:"ai-generate-status"},this.boundHandleMagicImport=this.handleMagicImport.bind(this),this.boundHandleAiGenerate=this.handleAiGenerate.bind(this),this.boundCloseForm=this.closeForm.bind(this),this.boundHandleSubmit=null,this.boundAddIngredient=null,this.init()}init(){this.bindElements(),this.modal&&this.attachListeners()}bindElements(){this.modal=document.getElementById(this.elementIds.modal),this.modal&&(this.form=document.getElementById(this.elementIds.form),this.title=document.getElementById(this.elementIds.title),this.recipeIdInput=document.getElementById(this.elementIds.idInput),this.recipeNameInput=document.getElementById(this.elementIds.nameInput),this.recipeCategoryInput=document.getElementById(this.elementIds.categoryInput),this.recipeServingsInput=document.getElementById(this.elementIds.servingsInput),this.recipePrepTimeInput=document.getElementById(this.elementIds.prepTimeInput),this.recipeDifficultyInput=document.getElementById(this.elementIds.difficultyInput),this.recipeStepsTextarea=document.getElementById(this.elementIds.stepsTextarea),this.ingredientsListDiv=document.getElementById(this.elementIds.ingredientsList),this.addIngredientBtn=document.getElementById(this.elementIds.addIngredientBtn),this.saveRecipeBtn=document.getElementById(this.elementIds.saveBtn),this.closeButton=document.getElementById(this.elementIds.closeBtn),this.cancelButton=document.getElementById(this.elementIds.cancelBtn),this.recipeImageUrlInput=document.getElementById(this.elementIds.imageUrlInput),this.magicImportUrl=document.getElementById(this.elementIds.magicImportUrl),this.magicImportBtn=document.getElementById(this.elementIds.magicImportBtn),this.magicImportStatus=document.getElementById(this.elementIds.magicImportStatus),this.aiGeneratePrompt=document.getElementById(this.elementIds.aiGeneratePrompt),this.aiGenerateBtn=document.getElementById(this.elementIds.aiGenerateBtn),this.aiGenerateStatus=document.getElementById(this.elementIds.aiGenerateStatus))}attachListeners(){this.listenersAttached||(this.closeButton.addEventListener("click",this.boundCloseForm),this.cancelButton.addEventListener("click",this.boundCloseForm),this.magicImportBtn&&this.magicImportBtn.addEventListener("click",this.boundHandleMagicImport),this.aiGenerateBtn&&this.aiGenerateBtn.addEventListener("click",this.boundHandleAiGenerate),this.form&&this.form.addEventListener("submit",e=>this.handleSubmit(e)),this.addIngredientBtn&&this.addIngredientBtn.addEventListener("click",()=>{this.addIngredientInput(void 0,this.currentIngredientsArray)}),this.initSeasonalityListeners(),this.listenersAttached=!0)}async handleAiGenerate(){const e=this.aiGeneratePrompt.value.trim();if(!e){alert("Veuillez d√©crire votre envie ou vos ingr√©dients.");return}this.aiGenerateStatus.classList.remove("hidden"),this.aiGenerateBtn.disabled=!0,this.aiGenerateBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i>';try{const c=await G(this.functions,"generateRecipe")({prompt:e}),r=c.data.data||c.data;if(r.error)throw new Error(r.error);this.populateFormFromAi(r),this.aiGenerateStatus.classList.add("hidden"),alert("Recette g√©n√©r√©e avec succ√®s !")}catch(s){console.error("Generation failed",s),alert("Erreur de g√©n√©ration : "+s.message),this.aiGenerateStatus.classList.add("hidden")}finally{this.aiGenerateBtn.disabled=!1,this.aiGenerateBtn.innerHTML='<i class="fas fa-lightbulb mr-2"></i> Cr√©er'}}async handleMagicImport(){const e=this.magicImportUrl.value.trim();if(!e){alert("Veuillez entrer une URL valide.");return}this.magicImportStatus.classList.remove("hidden"),this.magicImportBtn.disabled=!0,this.magicImportBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i>';try{const c=await G(this.functions,"extractRecipeFromUrl")({url:e}),r=c.data.data||c.data;if(r.error)throw new Error(r.error);this.populateFormFromAi(r),this.magicImportStatus.classList.add("hidden"),alert("Recette import√©e avec succ√®s !")}catch(s){console.error("Import failed",s),alert("Erreur lors de l'import : "+s.message),this.magicImportStatus.classList.add("hidden")}finally{this.magicImportBtn.disabled=!1,this.magicImportBtn.innerHTML='<i class="fas fa-magic mr-2"></i> Importer'}}async askAiForConversion(e,s,c,r){const a=`Convertis cette quantit√© d'ingr√©dient de son unit√© actuelle vers l'unit√© cible.
        Ingr√©dient: ${e}
        Quantit√© d'origine: ${s}
        Unit√© d'origine: ${c}
        Unit√© cible: ${r}
        
        R√©ponds UNIQUEMENT avec le chiffre (nombre ou fraction) correspondant √† la nouvelle quantit√©. Pas de texte, pas d'unit√©. Ex: "3" ou "0.5".`;try{const l=await G(this.functions,"generateRecipe")({prompt:a}),m=l.data.data||l.data;return(m.steps||m.toString()).replace(/[^0-9./]/g,"").trim()}catch(o){return console.error("AI Conversion error:",o),null}}populateFormFromAi(e){if(e.name&&(this.recipeNameInput.value=e.name),e.servings&&(this.recipeServingsInput.value=e.servings),e.prepTime&&(this.recipePrepTimeInput.value=e.prepTime),e.steps&&(this.recipeStepsTextarea.value=Array.isArray(e.steps)?e.steps.join(`
`):e.steps),e.category){const s=Array.from(this.recipeCategoryInput.options).map(r=>r.value),c=e.category.toUpperCase();s.includes(c)&&(this.recipeCategoryInput.value=c)}this.currentIngredientsArray&&e.ingredients&&(this.currentIngredientsArray.length=0,this.ingredientsListDiv.innerHTML="",e.ingredients.forEach(s=>{const c=s.name,r=this.masterIngredientList.some(a=>a.name.toLowerCase()===c.toLowerCase());this.addIngredientInput({name:c,quantity:s.quantity,unit:s.unit||"pi√®ce",originalUnit:s.unit||"pi√®ce",originalName:c},this.currentIngredientsArray,!r)}))}initSeasonalityListeners(){const e=document.querySelectorAll(".recipe-season-checkbox"),s=document.querySelectorAll(".recipe-month-checkbox");e.forEach(c=>{c.addEventListener("change",r=>{const a=r.target.value;document.querySelectorAll(`.recipe-month-checkbox[data-season="${a}"]`).forEach(l=>l.checked=r.target.checked)})}),s.forEach(c=>{c.addEventListener("change",r=>{const a=r.target.dataset.season,o=document.querySelector(`.recipe-season-checkbox[value="${a}"]`);if(r.target.checked)o&&(o.checked=!0);else{const l=document.querySelectorAll(`.recipe-month-checkbox[data-season="${a}"]:checked`);o&&l.length===0&&(o.checked=!1)}})})}setActivityUpdater(e){this.activityUpdater=e}async openForm(e=null,s="Ajouter une recette"){if(this.bindElements(),!this.modal)return;this.activityUpdater&&this.activityUpdater("editing_recipe"),await this.fetchMasterIngredients(),console.log("openForm called with recipe:",e,"and title:",s),this.form.reset(),this.ingredientsListDiv.innerHTML="",this.title.textContent=s,this.magicImportUrl&&(this.magicImportUrl.value=""),this.magicImportStatus&&this.magicImportStatus.classList.add("hidden"),this.aiGeneratePrompt&&(this.aiGeneratePrompt.value=""),this.aiGenerateStatus&&this.aiGenerateStatus.classList.add("hidden");let c=[];if(this.form.ingredients=c,this.currentIngredientsArray=c,e){this.currentRecipeOwnerId=e.userId,this.recipeIdInput.value=e.id||"",this.recipeNameInput.value=e.name||"";const r=e.category||"Plat";for(const l of this.recipeCategoryInput.options)if(l.value.toLowerCase()===r.toLowerCase()){l.selected=!0;break}this.recipeServingsInput.value=parseInt(e.servings)||"",this.recipePrepTimeInput.value=parseInt(e.prepTime)||"",this.recipeDifficultyInput.value=e.difficulty||"Moyen",this.recipeImageUrlInput.value=e.imageUrl||"",this.recipeStepsTextarea.value=e.steps||"";const a=e.seasons||[];["Printemps","Et√©","Automne","Hiver"].forEach(l=>{const m=`recipe-season-${l.toLowerCase().replace("√©","e")}`,p=document.getElementById(m);p&&(p.checked=a.includes(l))});const o=e.months||[];document.querySelectorAll(".recipe-month-checkbox").forEach(l=>{l.checked=o.includes(l.value)}),e.ingredients&&e.ingredients.length>0?e.ingredients.forEach(l=>this.addIngredientInput({...l},c)):this.addIngredientInput(void 0,c)}else this.currentRecipeOwnerId=null,this.recipeIdInput.value="",["Printemps","Et√©","Automne","Hiver"].forEach(r=>{const a=`recipe-season-${r.toLowerCase().replace("√©","e")}`,o=document.getElementById(a);o&&(o.checked=!1)}),document.querySelectorAll(".recipe-month-checkbox").forEach(r=>r.checked=!1),this.addIngredientInput(void 0,c);this.modal.classList.remove("hidden")}closeForm(){this.activityUpdater&&this.activityUpdater("idle"),this.modal.classList.add("hidden")}async fetchMasterIngredients(){if(this.masterIngredientList=[],!!this.db)try{const e=await j(P(this.db,"ingredients"));this.masterIngredientList=e.docs.map(s=>({id:s.id,...s.data()})),this.masterIngredientList.sort((s,c)=>s.name.localeCompare(c.name))}catch(e){console.error("Erreur lors de la r√©cup√©ration de la liste des ingr√©dients: ",e),alert("Impossible de charger la liste des ingr√©dients de base. La recherche ne fonctionnera pas.")}}addIngredientInput(e={quantity:"",name:"",unit:"",originalName:""},s,c=!1){const r=document.createElement("div");r.className="relative flex items-stretch space-x-2 ingredient-row";const a={...e};s.push(a);const o=s.length-1,l=document.createElement("input");l.type="text",l.className="ingredient-quantity mt-1 block w-1/4 rounded-md border-gray-300 shadow-sm",l.placeholder="Qt√©",l.value=a.quantity,l.addEventListener("change",g=>{s[o].quantity=g.target.value});const m=document.createElement("input");m.type="text",m.className="ingredient-unit mt-1 block w-1/4 rounded-md border-gray-300 shadow-sm bg-gray-100",m.placeholder="Unit√©",m.readOnly=!0,m.value=a.unit||"",m.addEventListener("change",g=>{s[o].unit=g.target.value});const p=document.createElement("div");p.className="w-1/2 flex items-center space-x-1";const S=document.createElement("div");S.className="relative flex-1";const u=document.createElement("input");u.type="text",u.className="ingredient-name mt-1 block w-full rounded-md border-gray-300 shadow-sm transition-all duration-200",u.placeholder="Chercher un ingr√©dient...",u.value=a.name,u.addEventListener("focus",()=>{u.select()});const T=async g=>{const n=g.toLowerCase();if(this.masterIngredientList.some(t=>t.name.toLowerCase()===n)){u.classList.remove("border-orange-500","bg-orange-50"),u.title="",E.classList.add("hidden");const t=this.masterIngredientList.find(i=>i.name.toLowerCase()===n);t&&(m.value=t.unit,m.readOnly=!0,m.classList.add("bg-gray-100"),s[o].id=t.id,s[o].unit=t.unit,a.originalUnit&&a.originalUnit!==t.unit&&a.quantity?(I.classList.remove("hidden"),I.title=`L'IA sugg√®re ${a.quantity} ${a.originalUnit}, mais votre unit√© standard est ${t.unit}. Cliquer pour convertir.`,u.classList.add("border-orange-500","bg-orange-50")):I.classList.add("hidden"))}else g.trim()!==""?(u.classList.add("border-orange-500","bg-orange-50"),u.title="Ingr√©dient inconnu. Cliquez sur '+' pour cr√©er ou restaurez l'original.",E.classList.remove("hidden"),I.classList.add("hidden"),m.readOnly=!1,m.classList.remove("bg-gray-100")):(u.classList.remove("border-orange-500","bg-orange-50"),E.classList.add("hidden"),I.classList.add("hidden"),m.readOnly=!1,m.classList.remove("bg-gray-100"));a.originalName&&g!==a.originalName?w.classList.remove("hidden"):w.classList.add("hidden")};c&&u.classList.add("border-orange-500","bg-orange-50"),S.appendChild(u),p.appendChild(S);const I=document.createElement("button");I.type="button",I.className="ml-1 p-1 rounded-full text-tomato bg-tomato/10 hover:bg-tomato/20 border border-tomato/30 hidden transition-all",I.innerHTML='<i class="fas fa-calculator"></i>',I.addEventListener("click",async()=>{const g=u.value,n=m.value,d=l.value,t=a.originalUnit;I.innerHTML='<i class="fas fa-spinner fa-spin"></i>',I.disabled=!0;try{const i=await this.askAiForConversion(g,d,t,n);i&&(l.value=i,s[o].quantity=i,alert(`Conversion effectu√©e : ${d} ${t} de ${g} vaut environ ${i} ${n}.`),a.originalUnit=n,T(g))}catch(i){console.error("Conversion failed",i),alert("√âchec de la conversion IA.")}finally{I.innerHTML='<i class="fas fa-calculator"></i>',I.disabled=!1}}),p.appendChild(I);const w=document.createElement("button");w.type="button",w.className="ml-1 p-1 rounded-full text-blue-500 hover:bg-blue-50 hidden transition-opacity",w.innerHTML='<i class="fas fa-undo"></i>',w.title=`Restaurer l'original: ${a.originalName}`,w.addEventListener("click",()=>{u.value=a.originalName,T(a.originalName),s[o].name=a.originalName}),p.appendChild(w);const E=document.createElement("button");E.type="button",E.className=`ml-1 p-1 rounded-full text-white bg-orange-500 hover:bg-orange-600 shadow-sm transition-opacity ${c?"":"hidden"}`,E.innerHTML='<i class="fas fa-plus"></i>',E.title="Cr√©er cet ingr√©dient",E.addEventListener("click",()=>{const g=u.value;q(async()=>{const{ingredientModalManager:n}=await import("./ingredient-modal-Bs8bmd4e.js");return{ingredientModalManager:n}},__vite__mapDeps([0,1,2,3])).then(({ingredientModalManager:n})=>{n.open(g,d=>{this.fetchMasterIngredients().then(()=>{u.value=d.name,T(d.name)})})})}),p.appendChild(E);const x=document.createElement("div");x.className="absolute z-50 left-0 right-0 top-full bg-white border border-gray-300 rounded-md shadow-lg mt-1 hidden max-h-48 overflow-y-auto",S.appendChild(x),u.addEventListener("input",()=>{const g=u.value;if(T(g),!g){x.classList.add("hidden");return}const n=g.toLowerCase(),d=this.masterIngredientList.filter(i=>i.name.toLowerCase().includes(n));x.innerHTML="",d.forEach(i=>{const h=document.createElement("div");h.className="p-2 ingredient-search-item cursor-pointer",h.textContent=i.name,h.addEventListener("click",()=>{u.value=i.name,m.value=i.unit,x.classList.add("hidden"),T(i.name),s[o].name=i.name,s[o].unit=i.unit,s[o].id=i.id}),x.appendChild(h)});const t=document.createElement("div");t.className="p-2 bg-blue-50 hover:bg-blue-200 cursor-pointer font-bold text-blue-700",t.textContent=`+ Cr√©er "${u.value}"`,t.addEventListener("click",()=>{const i=u.value;q(async()=>{const{ingredientModalManager:h}=await import("./ingredient-modal-Bs8bmd4e.js");return{ingredientModalManager:h}},__vite__mapDeps([0,1,2,3])).then(({ingredientModalManager:h})=>{h.open(i,b=>{this.fetchMasterIngredients().then(()=>{u.value=b.name,m.value=b.unit,x.classList.add("hidden"),s[o].name=b.name,s[o].unit=b.unit,s[o].id=b.id})})})}),x.appendChild(t),x.classList.remove("hidden")});const k=document.createElement("button");k.type="button",k.className="text-red-500 hover:bg-red-50 text-sm px-3 py-1 rounded-md mt-1",k.innerHTML='<i class="fas fa-trash"></i>',k.addEventListener("click",()=>{r.remove(),s[o]=null}),r.appendChild(p),r.appendChild(l),r.appendChild(m),r.appendChild(k),this.ingredientsListDiv.appendChild(r)}async handleSubmit(e){if(e.preventDefault(),this.ingredientsListDiv.querySelectorAll(".border-orange-500").length>0){alert(`Impossible d'enregistrer : vous avez des ingr√©dients inconnus (en orange).

Veuillez les cr√©er (+), les remplacer par des ingr√©dients existants, ou les supprimer.`);return}this.saveRecipeBtn.disabled=!0,this.saveRecipeBtn.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i> Sauvegarde...',console.log("Ingredients array from form before filter:",this.form.ingredients);const c=this.form.ingredients.filter(p=>p!==null&&p.quantity&&p.name),r=[];["Printemps","Et√©","Automne","Hiver"].forEach(p=>{const S=`recipe-season-${p.toLowerCase().replace("√©","e")}`,u=document.getElementById(S);u&&u.checked&&r.push(p)});const a=[];document.querySelectorAll(".recipe-month-checkbox:checked").forEach(p=>{a.push(p.value)});const o=X(),l={userId:this.currentRecipeOwnerId||o?.uid,authorName:(this.currentRecipeOwnerId?null:o?.displayName)||"Anonyme",name:this.recipeNameInput.value,category:this.recipeCategoryInput.value,servings:parseInt(this.recipeServingsInput.value)||0,prepTime:parseInt(this.recipePrepTimeInput.value)||0,difficulty:this.recipeDifficultyInput.value,seasons:r,months:a,steps:this.recipeStepsTextarea.value,ingredients:c,imageUrl:this.recipeImageUrlInput.value||`https://tse2.mm.bing.net/th?q=${encodeURIComponent(this.recipeNameInput.value)}%20recette&w=400&h=300&c=7&rs=1&p=0`};console.log("Recipe data being sent to Firebase:",l);const m=this.recipeIdInput.value;try{m?await V($(this.db,"recipes",m),l):await J(P(this.db,"recipes"),l),this.closeForm(),console.log("Recipe saved successfully!"),this.onSaveCallback&&this.onSaveCallback()}catch(p){console.error("Erreur de sauvegarde: ",p),alert("Une erreur est survenue lors de la sauvegarde.")}finally{this.saveRecipeBtn.disabled=!1,this.saveRecipeBtn.textContent="Sauvegarder"}}setOnSaveCallback(e){this.onSaveCallback=e}}const O=new Y;async function _(H,e){if(!H)return;const s=$(U,"recipes",H);try{await Q(s,{isFavorite:!e})}catch(c){console.error("Error toggling favorite status:",c)}}function Z(){const H=document.getElementById("search-bar"),e=document.getElementById("category-tabs"),s=document.getElementById("recipe-list-container"),c=document.getElementById("add-recipe-btn");O.setOnSaveCallback(()=>{});let r=[],a="",o="",l=null;const m=["Entr√©e","Plat","Accompagnement","Dessert"],p={PLAT:"bg-orange-100",DESSERT:"bg-amber-100",ENTREE:"bg-lime-100",ACCOMPAGNEMENT:"bg-stone-200","PETIT-DEJEUNER":"bg-orange-100",BOISSON:"bg-cyan-100",SAUCE:"bg-red-100"},S={PLAT:"text-orange-800",DESSERT:"text-amber-800",ENTREE:"text-lime-800",ACCOMPAGNEMENT:"text-stone-800","PETIT-DEJEUNER":"text-orange-800",BOISSON:"text-cyan-800",SAUCE:"text-red-800"},u="bg-gray-100",T="text-gray-800";function I(){return U?K(P(U,"recipes"),d=>{console.log("Recipe data updated on /recipes page from listener."),r=d.docs.map(t=>({id:t.id,...t.data()})),E(),x()},d=>{console.error("Erreur lors de l'√©coute des recettes: ",d)}):()=>{}}function w(n){a=n,E(),x()}function E(){if(!e)return;e.innerHTML="";const d=[...new Set(r.map(t=>t.category||"Non class√©"))].sort((t,i)=>{const h=R=>{const D=R.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();for(let B=0;B<m.length;B++)if(m[B].normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()===D)return B;return-1},b=h(t),L=h(i);return b>-1&&L>-1?b-L:b>-1?-1:L>-1?1:t.localeCompare(i)});!a&&d.length>0&&(a=d[0]),d.forEach(t=>{const i=document.createElement("button"),h=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase();if(t===a){const L=p[h]||u,R=S[h]||T;i.className=`px-4 py-2 text-sm font-bold rounded-t-lg ${L} ${R}`}else i.className="px-4 py-2 text-sm font-medium text-gray-500 hover:text-tomato";i.textContent=t,i.addEventListener("click",()=>w(t)),e.appendChild(i)})}function x(){if(!s)return;s.innerHTML="";let n=r.filter(t=>(t.category||"Non class√©")===a);if(o){const t=o.toLowerCase();n=n.filter(i=>i.name.toLowerCase().includes(t))}if(n.forEach(t=>t.seasonScore=M.getRecipeScore(t)),M.config.offSeasonBehavior==="hide"&&(n=n.filter(t=>t.seasonScore>0)),M.config.recipeRules.prioritizeSeasonal?n.sort((t,i)=>i.seasonScore!==t.seasonScore?i.seasonScore-t.seasonScore:t.name.localeCompare(i.name)):n.sort((t,i)=>t.name.localeCompare(i.name)),n.length===0){s.innerHTML='<p class="text-gray-500 text-center p-10">Aucune recette trouv√©e (ou masqu√©e par la saison).</p>';return}const d=document.createElement("div");d.className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",n.forEach(t=>{d.appendChild(k(t))}),s.appendChild(d)}function k(n){const d=document.createElement("div");if(d.className="bg-white shadow-md rounded-lg flex flex-col p-3",n.imageUrl){const f=document.createElement("div");f.className="relative w-full h-24 mb-2";const y=document.createElement("img");y.src=n.imageUrl,y.alt=n.name,y.className="w-full h-full object-cover rounded-md",f.appendChild(y);const N=n.seasonScore!==void 0?n.seasonScore:M.getRecipeScore(n);if(N===2&&M.config.mode!=="disabled"){const v=document.createElement("div");v.className="absolute top-1 right-1 bg-green-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-sm",v.textContent="De saison",f.appendChild(v)}else if(N===0&&M.config.mode!=="disabled"&&M.config.recipeRules.warnOffSeason){const v=document.createElement("div");v.className="absolute top-1 right-1 bg-gray-500/80 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-sm backdrop-blur-sm",v.textContent="Hors saison",f.appendChild(v),y.classList.add("grayscale-[50%]")}d.appendChild(f)}const t=document.createElement("div");t.className="w-full flex justify-between items-start";const i=document.createElement("h4");i.className="font-bold text-gray-800 pr-2",i.textContent=n.name,i.title=n.name,t.appendChild(i);const h=document.createElement("button");h.className="text-lg flex-shrink-0",h.innerHTML='<i class="fas fa-heart"></i>',n.isFavorite?h.classList.add("text-red-500"):h.classList.add("text-gray-300","hover:text-red-400"),h.addEventListener("click",f=>{f.stopPropagation(),_(n.id,n.isFavorite)}),t.appendChild(h),d.appendChild(t);const b=document.createElement("p");b.className="text-sm text-gray-600 mt-1 w-full",b.textContent=`${n.difficulty||""} - Pour ${n.servings||"?"} pers.`,d.appendChild(b);const L=document.createElement("div");L.className="w-full flex flex-col gap-1 mt-1 px-1";let R=!1;if(n.seasons&&n.seasons.length>0){R=!0;const f=document.createElement("div");f.className="flex flex-wrap gap-1";const y={Printemps:"üå∏",Et√©:"‚òÄÔ∏è",Automne:"üçÇ",Hiver:"‚ùÑÔ∏è"},N=["Printemps","Et√©","Automne","Hiver"];n.seasons.sort((v,C)=>N.indexOf(v)-N.indexOf(C)).forEach(v=>{const C=document.createElement("span");C.textContent=`${y[v]||""} ${v}`,C.title=v,C.className="text-[10px] text-gray-600 bg-gray-100 px-1.5 py-0.5 rounded-full border border-gray-200 whitespace-nowrap",f.appendChild(C)}),L.appendChild(f)}if(n.months&&n.months.length>0){R=!0;const f=document.createElement("div");f.className="flex flex-wrap gap-1";const y=["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"];let N=[...n.months];N.sort((v,C)=>y.indexOf(v)-y.indexOf(C)),N.forEach(v=>{const C=document.createElement("span");C.textContent=v.slice(0,3)+".",C.title=v,C.className="text-[10px] text-gray-600 bg-blue-50 px-1.5 py-0.5 rounded-full border border-blue-100 whitespace-nowrap",f.appendChild(C)}),L.appendChild(f)}if(!R){const f=document.createElement("div");f.className="flex flex-wrap gap-1";const y=document.createElement("span");y.textContent="Toute l'ann√©e üåç",y.className="text-[10px] text-green-700 bg-green-50 px-1.5 py-0.5 rounded-full border border-green-200 whitespace-nowrap",f.appendChild(y),L.appendChild(f)}d.appendChild(L);const D=document.createElement("div");D.className="flex-grow",d.appendChild(D);const B=document.createElement("div");B.className="w-full flex justify-end items-center space-x-2 border-t pt-2 mt-2";const A=document.createElement("button");A.className="text-blue-500 hover:bg-blue-50 text-sm px-3 py-1 rounded-md",A.innerHTML='<i class="fas fa-edit"></i>',A.title="Modifier",A.addEventListener("click",()=>O.openForm(n,"Modifier la recette")),B.appendChild(A);const F=document.createElement("button");return F.className="text-red-500 hover:bg-red-50 text-sm px-3 py-1 rounded-md",F.innerHTML='<i class="fas fa-trash-alt"></i>',F.title="Supprimer",F.addEventListener("click",()=>g(n.id,n.name)),B.appendChild(F),d.appendChild(B),d}async function g(n,d){if(confirm(`√ätes-vous s√ªr de vouloir supprimer la recette "${d}" ?`))try{await W($(U,"recipes",n)),fetchAllRecipes()}catch(t){console.error("Erreur lors de la suppression: ",t)}}if(c.addEventListener("click",()=>O.openForm(null,"Ajouter une recette")),H.addEventListener("input",n=>{const d=n.target.value;if(!o&&d&&(l=a),o=d,o){const t=o.toLowerCase(),i=r.find(h=>h.name.toLowerCase().includes(t));i&&(a=i.category||"Non class√©")}else l&&(a=l,l=null);E(),x()}),U)return I()}const ne=Object.freeze(Object.defineProperty({__proto__:null,default:Z,toggleFavoriteStatus:_},Symbol.toStringTag,{value:"Module"}));export{ne as a,O as r,_ as t};
