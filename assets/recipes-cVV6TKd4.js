import{d as g,g as M,c as D,f as F,a as O}from"./main--zY2HtAH.js";import{RecipeFormHandler as z}from"./form-handler-xDDizNKw.js";let p=null;function k(){const T=document.getElementById("search-bar"),E=document.getElementById("category-tabs"),f=document.getElementById("recipe-list-container"),L=document.getElementById("add-recipe-btn");p&&p.destroy(),p=new z(g,"recipe-form-modal","recipe-form","recipe-modal-title","recipe-id","recipe-name","recipe-category","recipe-servings","recipe-prep-time","recipe-difficulty","recipe-steps","ingredients-list","add-ingredient-btn","save-recipe-btn","close-recipe-modal","cancel-recipe-btn"),p.setOnSaveCallback(y);let u=[],s="",d="",C=null;const N=["Entrée","Plat","Accompagnement","Dessert"],v={PLAT:"bg-orange-100",DESSERT:"bg-amber-100",ENTREE:"bg-lime-100",ACCOMPAGNEMENT:"bg-stone-200","PETIT-DEJEUNER":"bg-orange-100",BOISSON:"bg-cyan-100",SAUCE:"bg-red-100"},S={PLAT:"text-orange-800",DESSERT:"text-amber-800",ENTREE:"text-lime-800",ACCOMPAGNEMENT:"text-stone-800","PETIT-DEJEUNER":"text-orange-800",BOISSON:"text-cyan-800",SAUCE:"text-red-800"},x="bg-gray-100",A="text-gray-800";async function y(){if(console.log("fetchAllRecipes called."),!!g)try{u=(await M(D(g,"recipes"))).docs.map(n=>({id:n.id,...n.data()})),console.log("Fetched recipes:",u),b(),h()}catch(t){console.error("Erreur lors de la récupération des recettes: ",t)}}function w(t){s=t,b(),h()}function b(){if(!E)return;E.innerHTML="";const n=[...new Set(u.map(e=>e.category||"Non classé"))].sort((e,r)=>{const o=c=>{const l=c.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();for(let m=0;m<N.length;m++)if(N[m].normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()===l)return m;return-1},i=o(e),a=o(r);return i>-1&&a>-1?i-a:i>-1?-1:a>-1?1:e.localeCompare(r)});!s&&n.length>0&&(s=n[0]),n.forEach(e=>{const r=document.createElement("button"),o=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase();if(e===s){const a=v[o]||x,c=S[o]||A;r.className=`px-4 py-2 text-sm font-bold rounded-t-lg ${a} ${c}`}else r.className="px-4 py-2 text-sm font-medium text-gray-500 hover:text-tomato";r.textContent=e,r.addEventListener("click",()=>w(e)),E.appendChild(r)})}function h(){if(!f)return;f.innerHTML="";let t=u.filter(e=>(e.category||"Non classé")===s);if(d){const e=d.toLowerCase();t=t.filter(r=>r.name.toLowerCase().includes(e))}if(t.sort((e,r)=>e.name.localeCompare(r.name)),t.length===0){f.innerHTML='<p class="text-gray-500 text-center p-10">Aucune recette trouvée.</p>';return}const n=document.createElement("div");n.className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",t.forEach(e=>{n.appendChild(R(e))}),f.appendChild(n)}function R(t){let n=x;if(t.category){const m=t.category.normalize("NFD").replace(/[̀-ͯ]/g,"").toUpperCase();n=v[m]||x}const e=document.createElement("div");e.className=`rounded-lg shadow-sm flex flex-col p-2 ${n}`;const r=document.createElement("h4");r.className="text-sm font-bold text-gray-800 truncate",r.textContent=t.name,r.title=t.name,e.appendChild(r);const o=document.createElement("p");o.className="text-xs text-gray-600 mt-1",o.textContent=`${t.difficulty||""} - Pour ${t.servings||"?"} pers.`,e.appendChild(o);const i=document.createElement("div");i.className="flex-grow",e.appendChild(i);const a=document.createElement("div");a.className="flex justify-end space-x-2 mt-2";const c=document.createElement("button");c.className="btn btn-outline btn-xs border-gray-400 hover:bg-gray-200",c.innerHTML='<i class="fas fa-edit"></i>',c.title="Modifier",c.addEventListener("click",()=>p.openForm(t,"Modifier la recette")),a.appendChild(c);const l=document.createElement("button");return l.className="btn btn-ghost text-red-700 hover:bg-red-100 btn-xs",l.innerHTML='<i class="fas fa-trash-alt"></i>',l.title="Supprimer",l.addEventListener("click",()=>B(t.id,t.name)),a.appendChild(l),e.appendChild(a),e}async function B(t,n){if(confirm(`Êtes-vous sûr de vouloir supprimer la recette "${n}" ?`))try{await F(O(g,"recipes",t)),y()}catch(e){console.error("Erreur lors de la suppression: ",e)}}L.addEventListener("click",()=>p.openForm(null,"Ajouter une recette")),T.addEventListener("input",t=>{const n=t.target.value;if(!d&&n&&(C=s),d=n,d){const e=d.toLowerCase(),r=u.find(o=>o.name.toLowerCase().includes(e));r&&(s=r.category||"Non classé")}else C&&(s=C,C=null);b(),h()}),g&&y()}export{k as default};
